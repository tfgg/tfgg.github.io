<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Tim Green</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <link href='/fonts/droid_serif.css' rel='stylesheet' type='text/css'>
    <link href='/fonts/droid_sans.css' rel='stylesheet' type='text/css'>
    <link href='/fonts/roboto_slab.css' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="/css/magres.css" />
    <link rel="stylesheet" href="/css/syntax.css" />

    <link rel="shortcut icon" type="image/png" href="/images/my_face.jpg"/>

    <script type='text/javascript' src='/js/jquery-2.1.4.min.js'></script>
    <script type='text/javascript' src='/js/d3.v3.min.js'></script>
    <script type='text/javascript' src='/js/charts.js'/></script>
  </head>
  <body>
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-593R7L"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-593R7L');</script>
<!-- End Google Tag Manager -->

    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script>

<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<div class="top-bar"><div class="inner">
  <a href='/'>Tim Green</a> / MagresPython
</div></div>

<div class="magres_heder"><div class="container">
<div class="col-md-6 col-md-offset-3 inner">
<!--<a href='/magres-python/install/' class='btn btn-default'>install</a>-->
<h1>The MagresPython library</h1>
</div>
</div></div>

<div class="container">
  <div class="row">
    <div class="col-md-3 sidebar">
        <!--<h3>Documentation</h3>-->
        <ul>
          <li><a class='link' href='/magres-python/'>Introduction</a></li>
          <li><a class='link' href='/magres-python/install/'>Installation</a></li> 
          <li><a class='link' href='/magres-python/scripts/'>Scripts</a></li>
          <li class='group'>Tutorials
            <ul>
              <!--<li><a class='link' href='/magres-python/tutorials/introduction/'>Introduction</a></li>-->
              <!--<li><a class='link' href='/magres-python/tutorials/atoms/'>Atoms</a></li>-->
              <li><a class='link' href='/magres-python/tutorials/structural/'>Distances and angles</a></li>
              <!--<li><a class='link' href='/magres-python/tutorials/bonding/'>Bonding</a></li>
              <li><a class='link' href='/magres-python/tutorials/cs/'>Chemical shifts</a></li>
              <li><a class='link' href='/magres-python/tutorials/efg/'>Electric field gradients</a></li>
              <li><a class='link' href='/magres-python/tutorials/jc/'>J-coupling</a></li>-->
              <li><a class='link' href='/magres-python/tutorials/disordered/'>Disordered systems</a></li>
            </ul>
          </li>
          <li><a class='external' href='https://github.com/tfgg/magres-format'>Available on Github</a></li>
        </ul>
      </div>
      <div class="col-md-6 content">
      <h1 id="available-scripts">Available scripts</h1>

<p>Some command-line scripts for extracting values from a large number of calculation output files are provided. Look at their help information for detailed instructions. If the script commands don&#39;t run correctly, <a href="/magres-python/install/">check the installation guide</a>, especially the section on setting environment variables.</p>

<h3 id="atom-list-specifiers"><a id="atom_lists"></a>Atom list specifiers</h3>

<p>All the scripts take an optional argument that specifies a subset of atoms to print the calculated properties (e.g. magnetic shielding) of. You can combine several ways to specify this atoms list.</p>

<p>You can select an entire species</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">H
</code></pre></div>
<p>will select all hydrogen atoms.</p>

<p>You can select a single atom</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">H2
</code></pre></div>
<p>will select the second hydrogen atom.</p>

<p>You can select ranges of atoms</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">H2-5
</code></pre></div>
<p>will select the second to fifth hydrogen atoms.</p>

<p>You can also chain these together with commas</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">H1-5,O
</code></pre></div>
<p>will select the first five hydrogen atoms and all oxygen atoms.</p>

<h2 id="magnetic-shieldings">Magnetic shieldings</h2>

<p>The <code>extract-ms.py</code> command-line script extracts magnetic shieldings from a single or a collection of <code>.magres</code> files. The input options are</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-ms.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-N<span class="o">]</span> <span class="nb">source</span> <span class="o">[</span>atoms<span class="o">]</span>
</code></pre></div>
<table class="table table-striped">
<thead>
<tr><th>Field</th> <th>Usage</th></tr>
</thead>
<tbody>
<tr><td>-h</td> <td>Show help <small>(option)</small></td></tr>
<tr><td>-N</td> <td>Parse numbers from path <small>(option)</small></td></tr>
<tr><td>source</td> <td>Directory of .magres files, or single file</td></tr>
<tr><td>atoms</td> <td><a href="#atom_lists">Atom list</a> string specifying subset to print <small>(option)</small></td></tr>
</tbody>
</table>

<p>The <code>source</code> is the directory location to look for <code>.magres</code> files in, or a specific <code>.magres</code> file. If you want to search in the current directly use <code>.</code>. Examples:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-ms.py .
extract-ms.py calcs
extract-ms.py ethanol.magres
</code></pre></div>
<p>each of which will print something like the following</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># Number  Atom  Iso Aniso Asym  Path
1H1 29.469  8.817 0.137 ./ethanol.magres
1H2 30.110  8.068 0.211 ./ethanol.magres
1H3 29.956  7.158 0.061 ./ethanol.magres
1H4 26.840  8.025 0.952 ./ethanol.magres
1H5 27.254  -7.043  0.899 ./ethanol.magres
1H6 31.838  14.111  0.454 ./ethanol.magres
13C1  157.312 33.765  0.699 ./ethanol.magres
13C2  110.691 70.018  0.416 ./ethanol.magres
17O1  267.788 -51.384 0.973 ./ethanol.magres
</code></pre></div>
<p>The optional <code>-h</code> flag will print the help information,</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-ms.py --help
</code></pre></div>
<p>and the optional <code>-N</code> flag is a tool for convergence calculations. If your calculations have a structure such as</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">calcs/cut_off_energy<span class="o">=</span>20/ethanol.magres
calcs/cut_off_energy<span class="o">=</span>30/ethanol.magres
calcs/cut_off_energy<span class="o">=</span>40/ethanol.magres
calcs/cut_off_energy<span class="o">=</span>50/ethanol.magres
calcs/cut_off_energy<span class="o">=</span>60/ethanol.magres
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">calcs/ethanol-20.magres
calcs/ethanol-30.magres
calcs/ethanol-40.magres
calcs/ethanol-50.magres
calcs/ethanol-60.magres
</code></pre></div>
<p>then the <code>-N</code> flag will attempt to parse out any numbers in the path and add them as columns to the beginning of the script output. This makes it easy to pipe the output to a data file and plot it using a tool such as <code>gnuplot</code>.</p>

<p>For example, the following will extract the magnetic shieldings for the C1 carbon atom in ethanol from a sequence of cut-off energy convergence calculations</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">20ry/ethanol.magres
30ry/ethanol.magres
40ry/ethanol.magres
50ry/ethanol.magres
60ry/ethanol.magres
</code></pre></div>
<p>and write them to a file called <code>out.dat</code></p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">  extract-ms.py -N . C1 &gt; out.dat
</code></pre></div>
<p>and the contents of <code>out.dat</code> is now</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># Number  Atom  Iso Aniso Asym  Path
20.0  13C1  176.526 32.537  0.676 ./20ry/ethanol.magres
30.0  13C1  161.170 33.686  0.707 ./30ry/ethanol.magres
40.0  13C1  157.699 33.744  0.700 ./40ry/ethanol.magres
50.0  13C1  157.312 33.765  0.699 ./50ry/ethanol.magres
60.0  13C1  157.351 33.769  0.699 ./60ry/ethanol.magres
</code></pre></div>
<p>which can be plotted as a graph using the <code>gnuplot</code> command</p>
<div class="highlight"><pre><code class="language-gnuplot" data-lang="gnuplot"><span class="k">plot</span> <span class="s">&#39;out.dat&#39;</span> <span class="nb">u</span> <span class="mi">1</span><span class="o">:</span><span class="mi">3</span> <span class="nb">w</span> <span class="n">lp</span>
</code></pre></div>
<h2 id="electric-field-gradients">Electric field gradients</h2>

<p>Similar to <code>extract-ms.py</code>, <code>extract-efg.py</code> is for extracting electric field gradients (quadrupolar couplings) from a collection of <code>.magres</code> files. The input options are</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-efg.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-N<span class="o">]</span> <span class="nb">source</span> <span class="o">[</span>atoms<span class="o">]</span>
</code></pre></div>
<table class="table table-striped">
<thead>
<tr><th>Field</th> <th>Usage</th></tr>
</thead>
<tbody>
<tr><td>-h</td> <td>Show help <small>(option)</small></td></tr>
<tr><td>-N</td> <td>Parse numbers from path <small>(option)</small></td></tr>
<tr><td>source</td> <td>Directory of .magres files, or single file</td></tr>
<tr><td>atoms</td> <td><a href="#atom_lists">Atom list</a> string specifying subset to print <small>(option)</small></td></tr>
</tbody>
</table>

<p>As with <code>extract-ms.py</code>, the <code>source</code> is the directory containing the <code>.magres</code> files, or a specific <code>.magres file</code>, the <code>-h</code> option will display the help information and <code>-N</code> will try to extract and output numerical parameters from the calculation paths.</p>

<p>An example output for the fluorine EFGs on the first eight fluorine atoms in a given calculation</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-efg.py Pb2ZnF6-MD-1000 F1-8
</code></pre></div><div class="highlight"><pre><code class="language-text" data-lang="text"># Atom  Cq  Eta Path
19F1  -16.25  -0.39 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F2  -17.88  -0.29 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F3  -14.61  -0.55 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F4  -13.47  -0.45 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F5  -18.19  -0.41 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F6  -16.98  -0.51 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F7  -16.23  -0.13 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
19F8  -8.50 -0.88 Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
</code></pre></div>
<p>or the (snipped) output of the EFG on the first fluorine atom over an entire MD run, using the <code>-N</code> option to provide a time counter in the first set of columns, amongst other junk.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># Number  Atom  Cq  Eta Path
2.0 6.0 1000.0 2.0 6.0 1000.0 19F1  -16.25  -0.39 ./Pb2ZnF6-MD-1000/Pb2ZnF6-MD-1000.magres
2.0 6.0 1200.0 2.0 6.0 1200.0 19F1  -14.04  -0.47 ./Pb2ZnF6-MD-1200/Pb2ZnF6-MD-1200.magres
2.0 6.0 1400.0 2.0 6.0 1400.0 19F1  -15.55  -0.45 ./Pb2ZnF6-MD-1400/Pb2ZnF6-MD-1400.magres
2.0 6.0 1600.0 2.0 6.0 1600.0 19F1  -21.41  -0.35 ./Pb2ZnF6-MD-1600/Pb2ZnF6-MD-1600.magres
2.0 6.0 1800.0 2.0 6.0 1800.0 19F1  -17.68  -0.39 ./Pb2ZnF6-MD-1800/Pb2ZnF6-MD-1800.magres
2.0 6.0 2000.0 2.0 6.0 2000.0 19F1  -14.93  -0.82 ./Pb2ZnF6-MD-2000/Pb2ZnF6-MD-2000.magres
2.0 6.0 2200.0 2.0 6.0 2200.0 19F1  -14.72  -0.51 ./Pb2ZnF6-MD-2200/Pb2ZnF6-MD-2200.magres
2.0 6.0 2400.0 2.0 6.0 2400.0 19F1  -14.46  -0.52 ./Pb2ZnF6-MD-2400/Pb2ZnF6-MD-2400.magres
2.0 6.0 2600.0 2.0 6.0 2600.0 19F1  -18.44  -0.61 ./Pb2ZnF6-MD-2600/Pb2ZnF6-MD-2600.magres
2.0 6.0 2800.0 2.0 6.0 2800.0 19F1  -18.37  -0.29 ./Pb2ZnF6-MD-2800/Pb2ZnF6-MD-2800.magres
2.0 6.0 3000.0 2.0 6.0 3000.0 19F1  -13.85  -0.62 ./Pb2ZnF6-MD-3000/Pb2ZnF6-MD-3000.magres
</code></pre></div>
<h2 id="j-couplings">J-couplings</h2>

<p>The <code>extract-jc.py</code> script, similarly to the other extract scripts, extracts J-couplings (indirect spin-spin coupling) from <code>.magres</code> output files of caclulations, either a set of them in a directory or a single one. The input options are</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">    extract-jc.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-J<span class="o">]</span> <span class="o">[</span>-S<span class="o">]</span> <span class="o">[</span>-N<span class="o">]</span> <span class="nb">source</span> <span class="o">[</span>atoms1<span class="o">]</span> <span class="o">[</span>atoms2<span class="o">]</span>
</code></pre></div>
<table class="table table-striped">
<thead>
<tr><th>Field</th> <th>Usage</th></tr>
</thead>
<tbody>
<tr><td>-h</td> <td>Show help <small>(option)</small></td></tr>
<tr><td>-J</td> <td>Show couplings in Hz, default is the reduced coupling <small>(option)</small></td></tr>
<tr><td>-S</td> <td>Sort couplings by strength, default is atom order <small>(option)</small></td></tr>
<tr><td>-N</td> <td>Parse numbers from path <small>(option)</small></td></tr>
<tr><td>source</td> <td>Directory of .magres files, or single file</td></tr>
<tr><td>atoms1</td> <td><a href="#atom_lists">Atom list</a> string specifying subset of atoms to print couplings <em>from</em> <small>(option)</small></td></tr>
<tr><td>atoms2</td> <td><a href="#atom_lists">Atom list</a> string specifying subset of atoms to print couplings <em>to</em> <small>(option)</small></td></tr>
</tbody>
</table>

<p>As with <code>extract-ms.py</code> and <code>extract-efg.py</code>, the <code>source</code> is the directory containing the <code>.magres</code> files, or a specific <code>.magres file</code>, the <code>-h</code> option will display the help information and <code>-N</code> will try to extract and output numerical parameters from the calculation paths.</p>

<p>The <code>-S</code> option will sort the couplings by strength, which is useful for spotting the largest couplings in a complex crystal! The <code>-J</code> option will print the couplings in hertz (Hz), rather than reduced units (10<sup>19</sup>T<sup>2</sup>J<sup>-1</sup>), which is usually observed experimentally, but depends on the exact isotope used.</p>

<p>The <code>atoms1</code> and <code>atoms2</code> options allow you to provide <a href="#atom_lists">atom lists</a> specifying the starting and ending atoms in the coupling.</p>

<p>For example, the following prints the couplings in hertz between the second selenium atom and all phosphorus atoms in the <code>.magres</code> files in the current directory</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash">extract-jc.py -J . Se2 P
</code></pre></div>
<p>giving output like</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"># Showing in Hz (J)
# Number  Atom1 Atom2 isc isc_fc  isc_spin  isc_orbital_p isc_orbital_d Dist  Path
77Se2 31P2 -0.064 -0.136  0.015 0.083 -0.027 6.838 ./Se2/21_211.magres
77Se2 31P3 -0.307 -0.517  0.118 0.119 -0.028 6.547 ./Se2/21_211.magres
77Se2 31P1 -324.039 -324.372  37.267  -37.047 0.113 2.254 ./Se2/21_211.magres
77Se2 31P4 348.006  347.126 -0.102  0.941 0.041 3.467 ./Se2/21_211.magres
</code></pre></div>
<h2 id="conversion-script-usage">Conversion script usage</h2>

<p>The <code>magres-convert.py</code> script converts an old-style <code>Castep</code> magres file to the new-style CCP-NC format for use with the new tools. You use it from the command line like:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">magres-convert.py sample.magres &gt; sample.new.magres
</code></pre></div>
<p>and optionally with the associated job&#39;s .castep file, to capture the lattice information,</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">magres_convert.py sample.magres sample.castep &gt; sample.new.magres
</code></pre></div>
    </div>
    <div class="col-md-3">
    </div>
  </div>
</div>
<div class="container-fluid">
  <div class="row footer">
    <div class='col-md-6 footer-left'>
      <p><a href='mailto:timothy.green@gmail.com'>timothy.green@gmail.com</a></p>
      <p><a href='http://twitter.com/tfgg2' target="_blank">Twitter @tfgg2</a></p>
      <p><a href='http://github.com/tfgg' target='_blank'>Github tfgg</a></p>
    </div>
    <div class='col-md-6 footer-right'>
      <address>
      Department of Materials<br/>
      University of Oxford<br/>
      Parks Road<br/>
      Oxford OX1 3PH<br/>
      UK
      </address>
    </div>
  </div>
</div>


  </body>
</html>

